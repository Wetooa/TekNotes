{% extends 'core/base.html' %}

{% load static %}

{% load custom_filters %}

{% block title %} {{ title }} {% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'teknotes/css/highlight.css' %}">

    <div class="flex flex-col w-full h-full gap-8 overflow-hidden overflow-y-auto">
        {% if users %}
            <div class="flex flex-col gap-3">
                {% for user in users %}
                    <div class="flex rounded-xl gap-3">
                        <img src="{% static 'teknotes/images/User.svg' %}" alt="User">
                        <p class="nav-text text-lg text-gray-700 font-medium">Users</p>
                    </div>
                    <a href="{% url 'authentication:profile' user.id %}" class="transition-all flex flex-wrap bg-gray-50 w-full p-6 gap-6 rounded-xl overflow-hidden shadow-xl justify-between hover:bg-gray-100">
                        <div class="flex gap-6">
                            <div class="flex aspect-square h-full rounded-full bg-[url('{{ user.profile.avatar.url }}')] bg-cover border-2 border-yellow-500 shadow-lg"></div>
                            <div class="flex flex-col gap-3 items-baseline">
                                <p class="text-2xl text-gray-700 font-semibold"> 
                                    {% highlight user.first_name query "user" %} {% highlight user.last_name query "user" %}
                                </p>
                                <p class="text-xl text-gray-500"> {% highlight user.email query "user" %} </p>
                                <p class="text-gray-700 text-xl">{% highlight user.profile.bio query "user" %}</p>
                            </div>
                        </div>
                        <div class="flex items-end gap-3 justify-between">
                            <div class="flex gap-2 bg-gray-200 rounded-lg overflow-hidden px-3 py-1.5">
                                <img src="{% static 'teknotes/images/notebook.svg' %}" alt="Notebook">
                                <p class="text-gray-700 text-lg">{{ user.notes.count }} notes</p>
                            </div>
                            <div class="flex gap-2 bg-gray-200 rounded-lg overflow-hidden px-3 py-1.5">
                                <img src="{% static 'teknotes/images/likes.svg' %}" alt="Like">
                                <p class="text-gray-700 text-lg">{{ user.likes.count }} likes</p>
                            </div>
                            <div class="flex gap-2 bg-gray-200 rounded-lg overflow-hidden px-3 py-1.5">
                                <img src="{% static 'teknotes/images/Course.svg' %}" alt="Course">
                                <p class="text-gray-700 text-lg">{{ user.courses.count }} courses</p>
                            </div>
                        </div>
                    </a>
                {% endfor %}
            </div>
        {% endif %}
        
        {% if course %}
            {% include 'course/course_button.html' with course=course unclickable=True %}
        {% endif %}
    
        {% if tags %}
            {% if not users and notes %}
                <div class="flex flex-col gap-3">
                    <div class="flex rounded-xl gap-3">
                        <img src="{% static 'teknotes/images/Tag.svg' %}" alt="Tag">
                        <p class="text-lg text-gray-700 font-medium">Tags</p>
                    </div>
                    {% include 'tags/course_and_tags.html' with wrap=True %}
                </div>
            {% endif %}
        {% endif %}
    
        {% if courses %}
            <div class="flex flex-col gap-3">
                <div class="flex rounded-xl gap-3">
                    <img src="{% static 'teknotes/images/Course.svg' %}" alt="Courses">
                    <p class="text-lg text-gray-700 font-medium">Courses</p>
                </div>
                <div class="flex flex-wrap gap-3">
                    {% for course in courses %}
                        {% include 'course/course_button.html' with course=course big=True %}
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    
        {% if notes %}
            <div class="flex flex-col gap-3">
                <div class="flex rounded-xl gap-3">
                    <img src="{% static 'teknotes/images/notebook.svg' %}" alt="Note">
                    <p class="text-lg text-gray-700 font-medium">Notes</p>
                </div>
                {% include 'notes/notes.html' with no_scroll=True %}
            </div>
        {% else %}
            {% if course %}
                {% include 'core/no_results.html' with message="No notes under" query=course.code %}
            {% endif %}
        {% endif %}

        {% if not users and not course and not tags and not courses and not notes %}
            {% include 'core/no_results.html' with message="No results for" query=query %}
        {% endif %}
    </div>
{% endblock %}
